<p align="center" >
  <img src="https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/assets/66541860/0fbed41e-1b2b-44f4-9562-6eb7aeeb2c7c" width="256" height="256" alt="NJS"></a>
</p>
<h1 align="center">Semi-Auto-NovelAI-to-Pixiv</h1>
<h4 align="center">‚ú®Generate Images with NovelAI and Upload to Pixiv‚ú®</h4>

<p align="center">
    <img src="https://img.shields.io/badge/Python-3.10+-blue">
    <a href="https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/raw/main/LICENSE"><img src="https://img.shields.io/github/license/zhulinyv/Semi-Auto-NovelAI-to-Pixiv" alt="license"></a>
    <img src="https://img.shields.io/github/issues/zhulinyv/Semi-Auto-NovelAI-to-Pixiv">
    <img src="https://img.shields.io/github/stars/zhulinyv/Semi-Auto-NovelAI-to-Pixiv">
    <img src="https://img.shields.io/github/forks/zhulinyv/Semi-Auto-NovelAI-to-Pixiv">
</p>

## üí¨ Introduction

**Translated by ChatGPT**

‚ú® **Currently implemented functions**:

| Feature | Description | Example | Note |
|:---:|:---:|:---:|:---:|
| Tutorial | Introduction and usage tutorial for this project | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/15.png?raw=true) | Please read carefully |
| Text-to-Image | A user interface for NovelAI using Gradio, functionally identical to using the NovelAI website except for the interface | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/1.png?raw=true) | Generated images will be saved to the `./output/t2i` folder |
| Random NSFW Image | Generates a NSFW image randomly using tags from `./files/favorite.json`, negative prompt words will be randomly chosen from the negative beliefs in favorite.json | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/3.png?raw=true) | For configuration of random NSFW images, please refer to the other parts of the WebUI configuration settings page |
| Random Image | Infinitely generates images using prompts from `*.txt` files in `./file/prompt` appended with user input, negative prompt words will be randomly chosen from the negative beliefs in favorite.json | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/4.png?raw=true) | For configuration of random images, please refer to the other parts of the WebUI configuration settings page |
| Image-to-Image | Functionally identical to using NovelAI website, supports any image, added batch processing | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/2.png?raw=true) | Generated images will be saved to the `./output/i2i` folder, a temporary image named `temp.png` will be generated in the `./output` folder, can be deleted, for batch processing, place images in the same folder, e.g., `./output/choose_to_i2i` |
| Partial Redraw | Supports images generated by NovelAI, requires uploading a mask, supports batch operations | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/5.png?raw=true) | Uploaded mask should have redrawn areas in white, remaining areas transparent (not black), resolution should match the redrawn image, for batch operations, place images and masks in two separate folders with identical filenames, e.g., `./output/inpaint/img`, `./output/inpaint/mask`, generated images will be saved to `./output/inpaint` |
| Vibe | Functionally identical to using NovelAI website, added batch functionality | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/16.png?raw=true) | Prepare some images in the same folder, rename images to `(any(not containing underscores))_(information extraction strength, float(0, 1))_(reference strength, float(0, 1)).png)` format, e.g., `hoshino-hinata_1.0_0.6`, when selecting random NSFW, infinite generation will follow random NSFW mode, otherwise, infinite generation will follow random image mode |
| Super Resolution Denoising | Utilizes open-source projects listed in the acknowledgments to perform super resolution denoising on images, supports single or batch processing | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/6.png?raw=true) | Generated images will be saved to the `./output/upscale` folder, not recommended to use **srmd-cuda** due to instability, when using **waifu2x-caffe** or **waifu2x-converter**, a temporary batch file named `temp.bat` will be generated in the `./output` folder, can be deleted, for batch processing, place images in the same folder, e.g., `./output/choose_to_upscale` |
| Auto Mosaic | Automatically detects key parts in images and mosaic them | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/7.png?raw=true) | Cannot guarantee 100% detection, generated images will be saved to the `./output/mosaic` folder, for batch processing, place images in the same folder, e.g., `./output/choose_to_mosaic` |
| Add Watermark | Adds a specified number of random watermarks with random transparency at random positions (top-left, top-right, bottom-left, bottom-right) on images | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/8.png?raw=true) | Prepare your watermarks in `./files/water` folder before usage. Enter the directory of images to be processed and click OK, processed images will be saved to the `./output/water` folder |
| Upload to Pixiv | Batch uploads images to Pixiv | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/9.png?raw=true) | For Pixiv upload configuration, please refer to other parts of the WebUI configuration settings page |
| Image Filtering | Tool for manually filtering images | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/10.png?raw=true) | Enter the image directory and press OK, then input the output directory. A file named `array_data.npy` will be generated in the `./output` folder, it saves the progress of the last filtering, so you can continue without selecting the image directory again, after filtering, it will be automatically deleted |
| Data Erasure | Batch erases, restores, or exports image generation information | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/11.png?raw=true) | For restoration, prepare at least a *.png image with prompt or a *.txt file containing prompt, and place it in a directory (image information file directory), the filenames (without extension) in the selected directory to be restored need to be consistent with those in the image information file directory |
| Magic Analysis | Reads png info using open-source projects listed in the acknowledgments | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/12.png?raw=true) | Embedded into this project via iframe |
| Tagger | Utilizing the reverse inference model deployed on Hugging Face by [SmilingWolf](https://huggingface.co/spaces/SmilingWolf/wd-tagger), I added batch operations to it | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/17.png?raw=true) | During batch processing, the generated prompt text will be saved to the same directory as the images |
| GPT Free | Free, multi-model GPT, utilizing open-source projects listed in the acknowledgments | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/13.png?raw=true) | Embedded into this project via iframe |
| Configuration Settings | Change configuration options in WebUI | ![image](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/blob/main/files/imgs/14.png?raw=true) | Remember to save changes, takes effect immediately after restart |

Learning Gradio, trying to create a WebUI for this project.

## üíª Configuration Requirements

| Item | Description |
|:---:|:---:|
| NovelAI Membership | To generate images infinitely, it is recommended to have a $25/month membership. |
| Magic Network | To successfully send POST requests, Magic Network is required. |
| 1GB VRAM | At least 1GB of VRAM is required to use all engines for super-resolution denoising. |
| 2GB RAM | At least 2GB of RAM is required for smooth operation of this project. |
| Windows 10/11(x64) | To use all features, a 64-bit version of Windows 10/11 is required. |
| [Microsoft Visual C++ 2015](https://www.microsoft.com/en-us/download/details.aspx?id=53587) | Installation of the runtime library is required to use all engines for super-resolution denoising. |

## üíø Deployment

### 1Ô∏è‚É£ Install Python

Suggested to install [Python 3.10.11](https://www.python.org/ftp/python/3.10.11/python-3.10.11-amd64.exe), During installation, please check **Add Python to PATH** and keep the rest as default.

### 2Ô∏è‚É£ Install Git

Suggested to install [Latest Version](https://git-scm.com/download/win), you just need to click **Next** button.

### 3Ô∏è‚É£ Clone Repositories

Open cmd/powershell, run `git clone -b main --depth=1 https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv.git`

### 4Ô∏è‚É£ Next step

Now you can launch the `run.bat` at the origin directory to start WebUI, it will create the virtual environment and install the dependences at the first time, it will take a long time, so you can drink some coffe or read the documents below

## ‚öôÔ∏è Configuration

‚ö†Ô∏è 1. If you have started the WebUI but haven't performed necessary configurations, please navigate to the settings page for necessary configurations.

‚ö†Ô∏è 2. Please do not skip this step, it's crucial. Make sure you have reviewed all configurations thoroughly.

‚ö†Ô∏è 3. Alternatively, you can directly edit the `.env` file for configurations.

‚ö†Ô∏è Getting the token:

- ![jc](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/assets/66541860/82f657fe-81bc-412b-a63c-11a878fde7d2)

‚ö†Ô∏è Getting pixiv_cookie and pixiv_token:

- 1. Open https://www.pixiv.net/illustration/create and manually upload an image.
- 2. Choose tags, age restrictions, AI-generated work, public range, comments on works, and original works.
- 3. Press F12 to open the console and switch to the Network tab.
- 4. Click on the submit button.
- 5. Find and click on the 'illustraion' request, then switch to the Headers tab.
- 6. In the request headers, you can find the Cookie and X-Csrf-Token.
- ![97ae3696ad11708ae2eb0474f198de0c](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/assets/66541860/e59caaf6-c69d-485e-965d-d7d924397667)

## üéâ Use

**Running `run.bat` will automatically open the default browser and navigate to [127.0.0.1:11451](http://127.0.0.1:11451).**

For legacy users: It's no longer recommended to run individual scripts; please use the WebUI instead.

If it's really necessary (for example: if the browser has been added to the sleep whitelist but still can't continue generating on inactive pages), please configure the directory and other parameters in the WebUI and click **Generate Standalone Script** (you can also read the source code yourself to write your own standalone script), then run the `run_stand_alone_scripts.bat` in the root directory.

If your want function do not in t2i, please submit issue or join my QQ group 632344043 or turn to: [Wiki](https://github.com/zhulinyv/Semi-Auto-NovelAI-to-Pixiv/wiki/%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91)

## üìñ To-Do

+ [x] Batch text-to-image generation
+ [x] Batch image-to-image generation
+ [x] Batch upload to Pixiv
+ [x] Calculate remaining crystals
+ [x] Batch [waifu2x](https://github.com/nagadomi/waifu2x)
+ [x] Batch local redraw
+ [x] ~~Batch vibe~~
+ [x] Batch mosaic
+ [x] Write a WebUI using Gradio
+ [ ] ~~Containerize the project for persistent running~~
+ [x] Change the style of the interface
+ [x] ~~Add ChatGPT~~
+ [x] ~~White a picture selector~~
+ [ ] ~~Get token by account and password~~
+ [x] Add more upscale engine
+ [x] Add more ways to t2i
+ [x] Batch watermarking
+ [x] Batch PNG info processing
+ [x] Configuration item interface
+ [x] Open related folders functionality
+ [x] Merge interfaces such as random NSFW
+ [ ] Hotkey for quick image filtering
+ [x] Tutorial and instruction pages
+ [x] Custom plugins
+ [x] Automatically generate standalone script
+ [x] Specify the number of Text-to-Image outputs
+ [x] Wensheng diagram seed click to switch randomly
+ [x] Add whether to restore image information in the configuration item
+ [ ] Complete independent script generation
+ [x] Picture save category
+ [ ] Support for non-literate diagram plugins
+ [ ] Video redrawing
+ [ ] Prompts inferr
+ [ ] ...

## ü§ù Acknowledgements

This project uses [waifu2x-ncnn-vulkan](https://github.com/nihui/waifu2x-ncnn-vulkan) | [Anime4KCPP](https://github.com/TianZerL/Anime4KCPP) | [realcugan-ncnn-vulkan](https://github.com/nihui/realcugan-ncnn-vulkan/) | [realesrgan-ncnn-vulkan](https://github.com/xinntao/Real-ESRGAN-ncnn-vulkan) | [realsr-ncnn-vulkan](https://github.com/nihui/realsr-ncnn-vulkan/) | [srmd-cuda](https://github.com/MrZihan/Super-resolution-SR-CUDA) | [srmd-ncnn-vulkan](https://github.com/nihui/srmd-ncnn-vulkan) | [waifu2x-caffe](https://github.com/lltcggie/waifu2x-caffe) | [waifu2x-converter](https://github.com/DeadSix27/waifu2x-converter-cpp) for denoising and upscaling images.

This project uses [stable-diffusion-inspector](https://spell.novelai.dev/) for parsing image metadata.

This project uses [Genshin-Sync](https://huggingface.co/spaces/AppleHarem/Genshin-Sync/tree/main) for uploading images to Pixiv.

This project uses [GPT4FREE](https://github.com/xtekky/gpt4free) to provide GPT services.

This project uses [novelai-image-metadata](https://github.com/NovelAI/novelai-image-metadata) to eraser the metadata.

This project uses [SmilingWolf/wd-tagger](https://huggingface.co/spaces/SmilingWolf/wd-tagger) to inferr Prompts.

<hr>
<img width="300px" src="https://count.getloli.com/get/@zhulinyv?theme=rule34"></img>
